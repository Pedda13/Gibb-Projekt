# Dieses Skript ermöglicht die Remote-Steuerung eines Computers über die Kommandozeile.
clear
while true
do
	while true
	do
		read -p "Please enter IP-Address to Remote control: " UserIPAddress
		if [ -z "$UserIPAddress" ]
		then
			clear
			echo "No Input"
			sleep 2
			continue
		fi
		IFS="." read -ra blocks <<< "$UserIPAddress"
		if [ ${#blocks[@]} -ne 4 ];
		then
			clear
			echo "Invalid IP-Address"
			sleep 2
			continue
		else
			valid=true
		fi
		for block in "${blocks[@]}";
		do
			if (( block > 0 && block < 256 ));
			then
				continue
			else
				valid=false
			fi
		done
		if [ $valid == true ]
		then
			break
		else
			clear
			echo "Invalid IP-Address"
			sleep 2
			continue
		fi
	done
	clear
	read -p "Please enter an Username which has enough permissions: " UserName
	if [ -z "$UserName" ]
	then
		clear
		echo "No user given, user set to root"
		sleep 2
		UserName="root"
	fi
	clear
	echo "Choose what you want to do:"
	select UserChoice in "Restart" "Shutdown" "Custom"
	do
		case $UserChoice in
			"Restart")
				ssh -t $UserName@$UserIPAddress "sudo shutdown now -r"
				while true
				do
					read -p "Do you want to use another IP? (y/n)" UserAgain
					if [ $UserAgain == "y" ]
					then
						break
					elif [ $UserAgain == "n" ]
					then
						clear
						exit
					else
						clear
						echo "Invalid Input"
						sleep 2
						continue
					fi
				done
				;;
			"Shutdown")
				ssh -t $UserName@$UserIPAddress "sudo shutdown now"
				while true
				do
					read -p "Do you wnat to use another IP? (y/n)" UserAgain
					if [ $UserAgain == "y" ]
					then
						break
					elif [ $UserAgain == "n" ]
					then
						clear
						exit
					else
						clear
						echo "Invalid Input"
						sleep 2
						continue
					fi
				done
				;;
			"Custom")
				clear
				while true
				do
					read -p "Please enter the command you want to use: " UserCommand
					if [ -z "$UserCommand" ]
					then
						clear
						echo "No Command was entered"
						sleep 2
						continue
					else
						break
					fi
				done
				ssh -t $UserName@$UserIPAddress "$UserCommand"
				while true
				do
					read -p "Do you want to use another IP? (y/n)" UserAgain
					if [ $UserAgain == "y" ]
					then
						break
					elif [ $UserAgain == "n" ]
					then
						clear
						exit
					else
						clear
						echo "Invalid Input"
						sleep 2
						continue
					fi
				done
				;;
			"Abbort")
				clear
				exit
				;;
			*)
				clear
				echo "Invalid Input"
				sleep 2
				continue
				;;
		esac
	done
done
clear
