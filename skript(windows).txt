Add-Type -AssemblyName System.Windows.Forms

# Define the form
$form = New-Object System.Windows.Forms.Form
$form.Text = "Remote Control"
$form.StartPosition = "CenterScreen"
$form.AutoSize = $true
$form.AutoSizeMode = "GrowAndShrink"

# Define the IP address text box
$ipLabel = New-Object System.Windows.Forms.Label
$ipLabel.Location = New-Object System.Drawing.Point(10, 15)
$ipLabel.Size = New-Object System.Drawing.Size(100, 23)
$ipLabel.Text = "IP Address:"
$form.Controls.Add($ipLabel)

$ipTextBox = New-Object System.Windows.Forms.TextBox
$ipTextBox.Location = New-Object System.Drawing.Point(120, 12)
$ipTextBox.Size = New-Object System.Drawing.Size(200, 23)
$form.Controls.Add($ipTextBox)

# Define the action radio buttons
$actionLabel = New-Object System.Windows.Forms.Label
$actionLabel.Location = New-Object System.Drawing.Point(10, 50)
$actionLabel.Size = New-Object System.Drawing.Size(100, 23)
$actionLabel.Text = "Action:"
$form.Controls.Add($actionLabel)

$restartRadioButton = New-Object System.Windows.Forms.RadioButton
$restartRadioButton.Location = New-Object System.Drawing.Point(120, 50)
$restartRadioButton.Size = New-Object System.Drawing.Size(100, 23)
$restartRadioButton.Text = "Restart"
$restartRadioButton.Checked = $true
$form.Controls.Add($restartRadioButton)

$shutdownRadioButton = New-Object System.Windows.Forms.RadioButton
$shutdownRadioButton.Location = New-Object System.Drawing.Point(240, 50)
$shutdownRadioButton.Size = New-Object System.Drawing.Size(100, 23)
$shutdownRadioButton.Text = "Shutdown"
$form.Controls.Add($shutdownRadioButton)

# Define the submit button
$submitButton = New-Object System.Windows.Forms.Button
$submitButton.Location = New-Object System.Drawing.Point(120, 90)
$submitButton.Size = New-Object System.Drawing.Size(100, 23)
$submitButton.Text = "Submit"
$submitButton.DialogResult = [System.Windows.Forms.DialogResult]::OK
$form.AcceptButton = $submitButton
$form.Controls.Add($submitButton)

# Show the form and wait for user input
$dialogResult = $form.ShowDialog()

# If the user clicked "Submit", perform the remote control action
if($dialogResult -eq [System.Windows.Forms.DialogResult]::OK) {
    $ipAddress = $ipTextBox.Text
    if($restartRadioButton.Checked) {
        ssh -t root@$ipAddress "shutdown now -r"
    } else {
        ssh -t root@$ipAddress "shutdown now"
    }
}

# Clean up the form
$form.Dispose()
